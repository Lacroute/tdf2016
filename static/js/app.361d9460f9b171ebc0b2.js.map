{"version":3,"sources":["webpack:///static/js/app.361d9460f9b171ebc0b2.js","webpack:///./src/main.js","webpack:///App.vue","webpack:///Race.vue","webpack:///Tdf.vue","webpack:///./src/App.vue?d818","webpack:///./src/components/Tdf.vue?0e48","webpack:///./src/components/Race.vue?6fd3","webpack:///./src/App.vue","webpack:///./src/components/Race.vue","webpack:///./src/components/Tdf.vue"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_vue","_vue2","_App","_App2","el","components","App","Object","defineProperty","value","_Tdf","_Tdf2","Tdf","name","props","race","methods","raceSelected","e","this","$dispatch","_Race","_Race2","L","Vue","use","map","layerGroup","Race","data","races","currentRace","computed","previousRace","stage","nextRace","ready","$http","get","then","jsonReady","JSON","parse","body","error","console","log","setView","tileLayer","attribution","maxZoom","id","accessToken","addTo","defaultStyle","color","weight","opacity","defaultStyleCircle","c","f","fillColor","fillOpacity","hightlightStyle","hightlightStyleCircleStart","hightlightStyleCircleEnd","getStageFromName","parseInt","match","replace","tdf","_this","that","geoJson","onEachFeature","feature","layer","featureName","properties","distance","split","coords","geometry","coordinates","start","end","length","raw","selected","circle","circleFactory","push","on","click","target","highlightFeature","style","l","_layers","_loop","i","layerId","_leaflet_id","find","r","updateRaces","setStyle","updateCamera","some","getLayer","bounds","latLngBounds","latLng","fitBounds","animate","pan","duration","events","race-selected","__vue_script__","__vue_template__","options","template"],"mappings":"AAAAA,cAAc,EAAE,IAEV,SAASC,EAAQC,EAASC,GAE/B,YAUA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GCdxF,GAAAG,GAAAL,EAAA,GDQKM,EAAQL,EAAuBI,GCPpCE,EAAAP,EAAA,IDWKQ,EAAQP,EAAuBM,ECRpC,IAAAD,eACEG,GAAI,OACJC,YAAcC,IAAAH,iBDgBT,CAED,SAASV,EAAQC,EAASC,GAE/B,YAUA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GARvFU,OAAOC,eAAed,EAAS,cAC7Be,OAAO,GEtBV,IAAAC,GAAAf,EAAA,IF2BKgB,EAAQf,EAAuBc,EAInChB,eACEW,YE5BHO,IAAAD,gBFmCM,SAASlB,EAAQC,GAEtB,YAEAa,QAAOC,eAAed,EAAS,cAC7Be,OAAO,IAETf,cACEmB,KG5CH,OH8CGC,OACEC,KG3CLR,QH8CGS,SACEC,aAAc,SAAsBC,GAClCC,KAAKC,UAAU,gBAAiBD,KG7CvCJ,UHoDM,SAAStB,EAAQC,EAASC,GAE/B,YAUA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GARvFU,OAAOC,eAAed,EAAS,cAC7Be,OAAO,GIvCV,IAAAY,GAAA1B,EAAA,IJ4CK2B,EAAS1B,EAAuByB,GI1CrCE,EAAA5B,EAAA,GACA6B,EAAA7B,EAAA,EACA6B,GAAAC,IAAA9B,EAAA,IACA,IAAA+B,GAGAC,CJ8CCjC,eACEmB,KI7CH,MJ8CGR,YI5CHuB,KAAAN,cJ8CGO,KAAM,WACJ,OACEC,SACAC,YI5CP,OJiDGC,UACEC,aAAc,WACZ,MAAOd,MAAKY,YAAYG,MI7C/B,GJgDKC,SAAU,WACR,MAAOhB,MAAKY,YAAYG,MI5C/B,IJgDGE,MAAO,WACLjB,KAAKkB,MAAMC,IAAI,0BI3CpBC,KAAA,SAAAV,GJ4COV,KAAKqB,UAAUC,KAAKC,MAAMb,EI1CjCc,QACA,SAAAC,GJ2COC,QAAQC,IIzCfF,KJ4CKlB,EAAMH,EAAEG,IAAI,SAASqB,SAAS,GAAI,GIrCvC,GJuCKxB,EAAEyB,UAAU,mFACVC,YItCP,6MJuCOC,QItCP,GJuCOC,GItCP,eJuCOC,YItCP,+FAJAC,MAKA3B,IJyCGV,SACEsC,aAAc,WACZ,OACEC,MIpCT,OJqCSC,OIpCT,EJqCSC,QInCT,KJuCKC,mBAAoB,SAA4BC,EAAGC,GACjD,OACEL,MInCT,OJoCSM,UInCT,OJoCSC,YIlCT,KJsCKC,gBAAiB,WACf,OACER,MIlCT,UJmCSC,OIlCT,EJmCSC,QIjCT,IJqCKO,2BAA4B,WAC1B,OACET,MIjCT,UJkCSM,UIjCT,UJkCSC,YIhCT,KJoCKG,yBAA0B,WACxB,OACEV,MIhCT,UJiCSM,UIhCT,UJiCSC,YI/BT,KJmCKI,iBAAkB,SAA0BrD,GAC1C,MAAOsD,UAAStD,EAAKuD,MAAM,gBAAgB,GAAGC,QAAQ,MI/B7D,MJkCK7B,UAAW,SAAmB8B,GI9BnC,GAAAC,GAAApD,KJiCWqD,EI/BXrD,IJiCOQ,GAAaJ,EIhCpBkD,QACAH,GJgCSI,cAAe,SAAuBC,EAASC,GAC7C,GAAIC,GAAcF,EAAQG,WI7BrCjE,KJ8BeqB,EAAQsC,EAAKN,iBI7B5BW,GJ8BeE,EAAWF,EAAYT,MAAM,aAAa,GAAGC,QAAQ,MI7BpE,GJ8BWQ,GAAcA,EAAYG,MAAM,KI7B3C,EJ8BW,IAAInE,GAAOgE,EAAYG,MAAM,MI7BxC,GJ8BeC,EAASN,EAAQO,SI7BhCC,YJ8BeC,EAAQH,EI7BvB,GJ8BeI,EAAMJ,EAAOA,EAAOK,OI3BnC,GJ6BevE,GACFmB,MI5BbA,EJ6BaL,MACE0D,II5BfV,EJ6BehE,KI5BfA,EJ6BekE,SAAUZ,SI3BzBY,IJ6BaK,MI5BbA,EJ6BaC,II5BbA,EJ6BaG,UIzBb,EJ4BWzE,GAAKqE,MAAMK,OAASjB,EAAKkB,cAAc3E,EAAKqE,MAAOZ,EI3B9Dd,sBJ4BW3C,EAAKsE,IAAII,OAASjB,EAAKkB,cAAc3E,EAAKsE,IAAKb,EI1B1Dd,sBJ4BWc,EAAK1C,MAAM6D,KI1BtB5E,GJ4BW6D,EI3BXgB,IJ4BaC,MAAS,SAAe3E,GACtB,GAAIgB,GAAQsC,EAAKN,iBAAiBhD,EAAE4E,OAAOnB,QAAQG,WIzBlEjE,KJ0Be2D,GAAKuB,iBIzBpB7D,OJ8BS8D,MAAO7E,KIxBhBmC,eA1CAD,MA6CA3B,EJwBO,IAAIuE,GAAItE,EIvBfuE,QJyBWC,EAAQ,SAAeC,GACzB,GAAIxB,GAAQqB,EIxBrBG,GJyBaC,EAAUzB,EIxBvB0B,YJyBapE,EAAQqC,EAAML,iBAAiBU,EAAMD,QAAQG,WIvB1DjE,MJyBaE,EAAOwD,EAAMzC,MAAMyE,KAAK,SAAUC,GACpC,MAAOA,GAAEtE,QIxBpBA,GJ0BSnB,GAAKsF,QIxBdA,EJ2BO,KAAK,GAAID,KAAKH,GInCrBE,EAAAC,IJwCKL,iBAAkB,SAA0B7D,GAC1Cf,KAAKY,YAAcZ,KAAKsF,YI3B/BvE,GJ4BOf,KAAKY,YAAYqD,MAAMK,OAAOiB,SAASvF,KI3B9C6C,8BJ4BO7C,KAAKY,YAAYsD,IAAII,OAAOiB,SAASvF,KI3B5C8C,4BJ4BO9C,KI3BPwF,gBJ8BKF,YAAa,SAAqBvE,GAChC,GI1BPsE,GAAA,OJ2BWhC,EI1BXrD,IJyCO,OAdAA,MAAKW,MAAM8E,KAAK,SAAU7F,GACpBA,EAAKyE,WACP7D,EAAWkF,SAAS9F,EAAKsF,SI1BpCK,SAAAlC,EAEAlB,gBJyBWvC,EAAKqE,MAAMK,OAAOiB,SAASlC,EIxBtCd,sBJyBW3C,EAAKsE,IAAII,OAAOiB,SAASlC,EIxBpCd,sBJyBW3C,EAAKyE,UIxBhB,GJ0BazE,EAAKmB,QAAUA,IACjBnB,EAAKyE,UIxBhB,EJyBWgB,EIxBXzF,EJyBWY,EAAWkF,SAASL,EAAEH,SIxBjCK,SAAAlC,EAEAT,sBAIAyC,GJyBKG,aAAc,WACZ,GAAIG,GAASvF,EIrBpBwF,aAAAxF,EAAAyF,OAAA7F,KAAAY,YAAAqD,MAAA,GAAAjE,KAAAY,YAAAqD,MACA,IAAA7D,EAAAyF,OAAA7F,KAAAY,YAAAsD,IAAA,GAAAlE,KAAAY,YAAAsD,IAIA,IJkBO3D,GIjBPuF,UACAH,GJiBSI,SIfT,EJgBSC,KACED,SIfX,EJgBWE,SIZX,MJiBK1B,cAAe,SAAuBT,EAAQe,GAC5C,MAAOzE,GIbdkE,QAAAR,EAAA,GAAAA,EACA,IACA,IACAe,GAAA3C,MACA3B,KJaG2F,QACEC,gBAAiB,SAAsBvG,GACrCI,KAAK4E,iBAAiBhF,EIN7BmB,WJaM,SAASzC,EAAQC,KAMjB,SAASD,EAAQC,KAMjB,SAASD,EAAQC,KAKhB,CAED,SAASD,EAAQC,GKnTvBD,EAAAC,QAAA,iBLyTM,SAASD,EAAQC,GMzTvBD,EAAAC,QAAA,grBN+TM,SAASD,EAAQC,GO/TvBD,EAAAC,QAAA,oJPqUM,SAASD,EAAQC,EAASC,GQrUhC,GAAA4H,GAAAC,CACA7H,GAAA,GACA4H,EAAA5H,EAAA,GACA6H,EAAA7H,EAAA,GACAF,EAAAC,QAAA6H,MACA9H,EAAAC,QAAAI,aAAAL,EAAAC,QAAAD,EAAAC,QAAAD,YACA+H,KACA,kBAAA/H,GAAAC,QAAAD,EAAAC,QAAA+H,UAAAhI,EAAAC,QAAA+H,YAA+FhI,EAAAC,SAAAgI,SAAAF,IR6UzF,SAAS/H,EAAQC,EAASC,GSpVhC,GAAA4H,GAAAC,CACA7H,GAAA,GACA4H,EAAA5H,EAAA,GACA6H,EAAA7H,EAAA,IACAF,EAAAC,QAAA6H,MACA9H,EAAAC,QAAAI,aAAAL,EAAAC,QAAAD,EAAAC,QAAAD,YACA+H,KACA,kBAAA/H,GAAAC,QAAAD,EAAAC,QAAA+H,UAAAhI,EAAAC,QAAA+H,YAA+FhI,EAAAC,SAAAgI,SAAAF,IT4VzF,SAAS/H,EAAQC,EAASC,GUnWhC,GAAA4H,GAAAC,CACA7H,GAAA,GACA4H,EAAA5H,EAAA,GACA6H,EAAA7H,EAAA,IACAF,EAAAC,QAAA6H,MACA9H,EAAAC,QAAAI,aAAAL,EAAAC,QAAAD,EAAAC,QAAAD,YACA+H,KACA,kBAAA/H,GAAAC,QAAAD,EAAAC,QAAA+H,UAAAhI,EAAAC,QAAA+H,YAA+FhI,EAAAC,SAAAgI,SAAAF","file":"static/js/app.361d9460f9b171ebc0b2.js","sourcesContent":["webpackJsonp([1,0],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _vue = __webpack_require__(1);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _App = __webpack_require__(12);\n\t\n\tvar _App2 = _interopRequireDefault(_App);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tnew _vue2.default({\n\t  el: 'body',\n\t  components: { App: _App2.default }\n\t});\n\n/***/ },\n/* 1 */,\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _Tdf = __webpack_require__(14);\n\t\n\tvar _Tdf2 = _interopRequireDefault(_Tdf);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = {\n\t  components: {\n\t    Tdf: _Tdf2.default\n\t  }\n\t};\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = {\n\t  name: 'Race',\n\t\n\t  props: {\n\t    race: Object\n\t  },\n\t\n\t  methods: {\n\t    raceSelected: function raceSelected(e) {\n\t      this.$dispatch('race-selected', this.race);\n\t    }\n\t  }\n\t};\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _Race = __webpack_require__(13);\n\t\n\tvar _Race2 = _interopRequireDefault(_Race);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar L = __webpack_require__(8);\n\tvar Vue = __webpack_require__(1);\n\tVue.use(__webpack_require__(15));\n\tvar map;\n\tvar layerGroup;\n\t\n\texports.default = {\n\t  name: 'Tdf',\n\t  components: { Race: _Race2.default },\n\t\n\t  data: function data() {\n\t    return {\n\t      races: [],\n\t      currentRace: null\n\t    };\n\t  },\n\t\n\t\n\t  computed: {\n\t    previousRace: function previousRace() {\n\t      return this.currentRace.stage - 1;\n\t    },\n\t\n\t    nextRace: function nextRace() {\n\t      return this.currentRace.stage + 1;\n\t    }\n\t  },\n\t\n\t  ready: function ready() {\n\t    this.$http.get('static/tdf2016.geojson').then(function (data) {\n\t      this.jsonReady(JSON.parse(data.body));\n\t    }, function (error) {\n\t      console.log(error);\n\t    });\n\t\n\t    map = L.map('mapid').setView([46, 2], 6);\n\t\n\t    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {\n\t      attribution: 'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"http://mapbox.com\">Mapbox</a>',\n\t      maxZoom: 18,\n\t      id: 'mapbox.light',\n\t      accessToken: 'pk.eyJ1IjoibGFjcm91dGUiLCJhIjoiY2lxcDhoZXpqMDA1M2h4bms4YWRyNGlzbiJ9.VLlfBQGaxNFE9M_Ug3YXhQ'\n\t    }).addTo(map);\n\t  },\n\t\n\t  methods: {\n\t    defaultStyle: function defaultStyle() {\n\t      return {\n\t        color: '#000',\n\t        weight: 5,\n\t        opacity: 0.4\n\t      };\n\t    },\n\t\n\t    defaultStyleCircle: function defaultStyleCircle(c, f) {\n\t      return {\n\t        color: '#333',\n\t        fillColor: '#000',\n\t        fillOpacity: 0.3\n\t      };\n\t    },\n\t\n\t    hightlightStyle: function hightlightStyle() {\n\t      return {\n\t        color: '#f5da3f',\n\t        weight: 3,\n\t        opacity: 1\n\t      };\n\t    },\n\t\n\t    hightlightStyleCircleStart: function hightlightStyleCircleStart() {\n\t      return {\n\t        color: '#00A388',\n\t        fillColor: '#79BD8F',\n\t        fillOpacity: 0.8\n\t      };\n\t    },\n\t\n\t    hightlightStyleCircleEnd: function hightlightStyleCircleEnd() {\n\t      return {\n\t        color: '#CD2C24',\n\t        fillColor: '#F2836B',\n\t        fillOpacity: 0.8\n\t      };\n\t    },\n\t\n\t    getStageFromName: function getStageFromName(name) {\n\t      return parseInt(name.match(/Stage [0-9]+/)[0].replace(/\\D/g, ''));\n\t    },\n\t\n\t    jsonReady: function jsonReady(tdf) {\n\t      var _this = this;\n\t\n\t      var that = this;\n\t\n\t      layerGroup = L.geoJson(tdf, {\n\t        onEachFeature: function onEachFeature(feature, layer) {\n\t          var featureName = feature.properties.name;\n\t          var stage = that.getStageFromName(featureName);\n\t          var distance = featureName.match(/[0-9]+ km/)[0].replace(/\\D/g, '');\n\t          featureName = featureName.split(':')[1];\n\t          var name = featureName.split('km')[1];\n\t          var coords = feature.geometry.coordinates;\n\t          var start = coords[0];\n\t          var end = coords[coords.length - 1];\n\t\n\t          var race = {\n\t            stage: stage,\n\t            data: {\n\t              raw: featureName,\n\t              name: name,\n\t              distance: parseInt(distance)\n\t            },\n\t            start: start,\n\t            end: end,\n\t            selected: false\n\t          };\n\t\n\t          race.start.circle = that.circleFactory(race.start, that.defaultStyleCircle());\n\t          race.end.circle = that.circleFactory(race.end, that.defaultStyleCircle());\n\t\n\t          that.races.push(race);\n\t\n\t          layer.on({\n\t            'click': function click(e) {\n\t              var stage = that.getStageFromName(e.target.feature.properties.name);\n\t              that.highlightFeature(stage);\n\t            }\n\t          });\n\t        },\n\t\n\t        style: this.defaultStyle\n\t      }).addTo(map);\n\t\n\t      var l = layerGroup._layers;\n\t\n\t      var _loop = function _loop(i) {\n\t        var layer = l[i];\n\t        var layerId = layer._leaflet_id;\n\t        var stage = _this.getStageFromName(layer.feature.properties.name);\n\t\n\t        var race = _this.races.find(function (r) {\n\t          return r.stage === stage;\n\t        });\n\t        race.layerId = layerId;\n\t      };\n\t\n\t      for (var i in l) {\n\t        _loop(i);\n\t      }\n\t    },\n\t\n\t    highlightFeature: function highlightFeature(stage) {\n\t      this.currentRace = this.updateRaces(stage);\n\t      this.currentRace.start.circle.setStyle(this.hightlightStyleCircleStart());\n\t      this.currentRace.end.circle.setStyle(this.hightlightStyleCircleEnd());\n\t      this.updateCamera();\n\t    },\n\t\n\t    updateRaces: function updateRaces(stage) {\n\t      var r = void 0;\n\t      var that = this;\n\t      this.races.some(function (race) {\n\t        if (race.selected) {\n\t          layerGroup.getLayer(race.layerId).setStyle(that.defaultStyle());\n\t          race.start.circle.setStyle(that.defaultStyleCircle());\n\t          race.end.circle.setStyle(that.defaultStyleCircle());\n\t          race.selected = false;\n\t        }\n\t        if (race.stage === stage) {\n\t          race.selected = true;\n\t          r = race;\n\t          layerGroup.getLayer(r.layerId).setStyle(that.hightlightStyle());\n\t        }\n\t      });\n\t\n\t      return r;\n\t    },\n\t\n\t    updateCamera: function updateCamera() {\n\t      var bounds = L.latLngBounds(L.latLng(this.currentRace.start[1], this.currentRace.start[0]), L.latLng(this.currentRace.end[1], this.currentRace.end[0]));\n\t\n\t      map.fitBounds(bounds, {\n\t        animate: true,\n\t        pan: {\n\t          animate: true,\n\t          duration: 1\n\t        }\n\t      });\n\t    },\n\t\n\t    circleFactory: function circleFactory(coords, style) {\n\t      return L.circle([coords[1], coords[0]], 500, style).addTo(map);\n\t    }\n\t  },\n\t\n\t  events: {\n\t    'race-selected': function raceSelected(race) {\n\t      this.highlightFeature(race.stage);\n\t    }\n\t  }\n\t};\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ },\n/* 8 */,\n/* 9 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \" <tdf></tdf> \";\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \" <div class=race-selector> <race v-for=\\\"race in races | orderBy 'stage'\\\" :race=race> </race> </div> <section class=race-overview> <header> <div v-if=\\\"currentRace != null\\\"> <div class=navigator> <p v-show=\\\"previousRace > 0\\\" v-on:click=highlightFeature(previousRace)> Étape {{ previousRace }} ← </p> <p v-show=\\\"previousRace < races.length\\\" v-on:click=highlightFeature(nextRace)> → Étape {{ nextRace }} </p> </div> <p> Étape {{ currentRace.stage }} <span>{{ currentRace.data.name }}<span> </span></span></p> </div> <div v-else class=start> <p v-on:click=highlightFeature(1)> Tour de France 2016 <span>Cliquez pour commencer</span> </p> </div> </header> </section> <div id=mapid></div> \";\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \" <div v-bind:class=\\\"{ 'active': race.selected }\\\" v-on:click=raceSelected _v-439c647b=\\\"\\\"> Étape {{ race.stage }} : {{ race.data.name }} </div> \";\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(5)\n\t__vue_script__ = __webpack_require__(2)\n\t__vue_template__ = __webpack_require__(9)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(7)\n\t__vue_script__ = __webpack_require__(3)\n\t__vue_template__ = __webpack_require__(11)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\t__webpack_require__(6)\n\t__vue_script__ = __webpack_require__(4)\n\t__vue_template__ = __webpack_require__(10)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tif (__vue_template__) {\n\t(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n\t}\n\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** static/js/app.361d9460f9b171ebc0b2.js\n **/","import Vue from 'vue'\nimport App from './App'\n\n/* eslint-disable no-new */\nnew Vue({\n  el: 'body',\n  components: { App }\n})\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/main.js\n **/","<template>\n  <tdf></tdf>\n</template>\n\n<script>\nimport Tdf from './components/Tdf'\n\nexport default {\n  components: {\n    Tdf\n  }\n}\n</script>\n\n<style>\nhtml {\n  height: 100%;\n}\n\nbody {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n\n#app {\n  color: #2c3e50;\n  margin-top: -100px;\n  max-width: 600px;\n  font-family: Source Sans Pro, Helvetica, sans-serif;\n  text-align: center;\n}\n\n#app a {\n  color: #42b983;\n  text-decoration: none;\n}\n\n.logo {\n  width: 100px;\n  height: 100px\n}\n</style>\n\n\n\n/** WEBPACK FOOTER **\n ** App.vue?30263d95\n **/","<template>\r\n  <div v-bind:class=\"{ 'active': race.selected }\" v-on:click=raceSelected>\r\n    Étape {{ race.stage }} : {{ race.data.name }}\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Race',\r\n\r\n  props: {\r\n    race: Object\r\n  },\r\n\r\n  methods: {\r\n    raceSelected: function (e) {\r\n      this.$dispatch('race-selected', this.race)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\ndiv{\r\n  color: #000;\r\n  font-family: 'Lato', sans-serif;\r\n  font-weight: 300;\r\n}\r\n.active {\r\n  background: #f5da3f;\r\n  font-weight: 700;\r\n}\r\n\r\ndiv:hover{\r\n  cursor: pointer;\r\n  background: rgba(255, 255, 0, 0.6);\r\n}\r\n</style>\r\n\n\n\n/** WEBPACK FOOTER **\n ** Race.vue?44ca0d76\n **/","<template>\n  <div class=\"race-selector\">\n    <race v-for=\"race in races | orderBy 'stage'\"\n      :race=\"race\">\n    </race>\n  </div>\n  <section class=\"race-overview\">\n    <header>\n      <div v-if=\"currentRace != null\">\n        <div class=\"navigator\">\n          <p v-show=\"previousRace > 0\" v-on:click=highlightFeature(previousRace)>\n            Étape {{ previousRace }} ←\n          </p>\n          <p v-show=\"previousRace < races.length\" v-on:click=highlightFeature(nextRace)>\n            → Étape {{ nextRace }}\n          </p>\n        </div>\n\n        <p>\n          Étape {{ currentRace.stage }}\n        <span>{{ currentRace.data.name }}<span>\n        </p>\n      </div>\n      <div v-else class=\"start\">\n        <p v-on:click=highlightFeature(1)>\n          Tour de France 2016\n          <span>Cliquez pour commencer</span>\n        </p>\n      </div>\n    </header>\n  </section>\n  <div id=\"mapid\"></div>\n</template>\n\n<script>\nimport Race from './Race.vue'\n\nvar L = require('leaflet')\nvar Vue = require('vue')\nVue.use(require('vue-resource'))\nvar map\nvar layerGroup\n\nexport default {\n  name: 'Tdf',\n  components: {Race},\n\n  data () {\n    return {\n      races: [],\n      currentRace: null\n    }\n  },\n\n  computed: {\n    // Return the previous race\n    previousRace: function () {\n      return this.currentRace.stage - 1\n    },\n\n    // Return the next race\n    nextRace: function () {\n      return this.currentRace.stage + 1\n    }\n  },\n\n  ready: function () {\n    // Get asynchronous data.\n    this.$http.get('static/tdf2016.geojson').then(\n      function (data) {\n        this.jsonReady(JSON.parse(data.body))\n      },\n      function (error) {\n        console.log(error)\n      }\n    )\n\n    // Build the map.\n    map = L.map('mapid').setView([46, 2], 6)\n\n    // Set custom tile layer from mapbox\n    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {\n      attribution: 'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery © <a href=\"http://mapbox.com\">Mapbox</a>',\n      maxZoom: 18,\n      id: 'mapbox.light',\n      accessToken: 'pk.eyJ1IjoibGFjcm91dGUiLCJhIjoiY2lxcDhoZXpqMDA1M2h4bms4YWRyNGlzbiJ9.VLlfBQGaxNFE9M_Ug3YXhQ'\n    }).addTo(map)\n  },\n\n  methods: {\n\n    // Defult style for the race vectors.\n    defaultStyle: function () {\n      return {\n        color: '#000',\n        weight: 5,\n        opacity: 0.4\n      }\n    },\n\n    // Default style for the cities\n    defaultStyleCircle: function (c, f) {\n      return {\n        color: '#333',\n        fillColor: '#000',\n        fillOpacity: 0.3\n      }\n    },\n\n    // When a race is on focus.\n    hightlightStyle: function () {\n      return {\n        color: '#f5da3f',\n        weight: 3,\n        opacity: 1\n      }\n    },\n\n    // Highlight city circle start\n    hightlightStyleCircleStart: function () {\n      return {\n        color: '#00A388',\n        fillColor: '#79BD8F',\n        fillOpacity: 0.8\n      }\n    },\n\n    // Highlight city circle end\n    hightlightStyleCircleEnd: function () {\n      return {\n        color: '#CD2C24',\n        fillColor: '#F2836B',\n        fillOpacity: 0.8\n      }\n    },\n\n    // Helper to extract the integer stage from the string name.\n    getStageFromName (name) {\n      return parseInt(name.match(/Stage [0-9]+/)[0].replace(/\\D/g, ''))\n    },\n\n    // When data is loaded.\n    jsonReady: function (tdf) {\n      var that = this\n\n      layerGroup = L.geoJson(\n        tdf,\n        {\n          onEachFeature: function (feature, layer) {\n            // Clean data to build better format.\n            var featureName = feature.properties.name\n            var stage = that.getStageFromName(featureName)\n            var distance = featureName.match(/[0-9]+ km/)[0].replace(/\\D/g, '')\n            featureName = featureName.split(':')[1]\n            var name = featureName.split('km')[1]\n            var coords = feature.geometry.coordinates\n            var start = coords[0]\n            var end = coords[coords.length - 1]\n\n            // Store it.\n            let race = {\n              stage: stage,\n              data: {\n                raw: featureName,\n                name: name,\n                distance: parseInt(distance)\n              },\n              start: start,\n              end: end,\n              selected: false\n            }\n\n            // Draw default start and end circles.\n            race.start.circle = that.circleFactory(race.start, that.defaultStyleCircle())\n            race.end.circle = that.circleFactory(race.end, that.defaultStyleCircle())\n\n            that.races.push(race)\n\n            layer.on(\n              {\n                'click': function (e) {\n                  // highlight the feature\n                  var stage = that.getStageFromName(e.target.feature.properties.name)\n                  that.highlightFeature(stage)\n                }\n              })\n          },\n\n          style: this.defaultStyle\n        }\n      ).addTo(map)\n\n      // Iterate through the layer because the _leaflet_id is not readable in onEachFeature function\n      let l = layerGroup._layers\n      for (let i in l) {\n        let layer = l[i]\n        let layerId = layer._leaflet_id\n        let stage = this.getStageFromName(layer.feature.properties.name)\n\n        let race = this.races.find(function (r) {\n          return r.stage === stage\n        })\n        race.layerId = layerId\n      }\n    },\n\n    // Main function for higlighting.\n    highlightFeature: function (stage) {\n      this.currentRace = this.updateRaces(stage)\n      this.currentRace.start.circle.setStyle(this.hightlightStyleCircleStart())\n      this.currentRace.end.circle.setStyle(this.hightlightStyleCircleEnd())\n      this.updateCamera()\n    },\n\n    // Update all the races.\n    updateRaces: function (stage) {\n      let r\n      let that = this\n      this.races.some(function (race) {\n        if (race.selected) {\n          layerGroup.getLayer(race.layerId).setStyle(\n            that.defaultStyle()\n          )\n          race.start.circle.setStyle(that.defaultStyleCircle())\n          race.end.circle.setStyle(that.defaultStyleCircle())\n          race.selected = false\n        }\n        if (race.stage === stage) {\n          race.selected = true\n          r = race\n          layerGroup.getLayer(r.layerId).setStyle(\n            that.hightlightStyle()\n          )\n        }\n      })\n\n      return r\n    },\n\n    // Move the camera to the specific race\n    updateCamera: function () {\n      var bounds = L.latLngBounds(\n        L.latLng(this.currentRace.start[1], this.currentRace.start[0]),\n        L.latLng(this.currentRace.end[1], this.currentRace.end[0])\n      )\n\n      // map.panInsideBounds(bounds)\n      map.fitBounds(\n        bounds,\n        {\n          animate: true,\n          pan: {\n            animate: true,\n            duration: 1\n          }\n        }\n      )\n    },\n\n    // Helper to draw circles.\n    circleFactory: function (coords, style) {\n      return L.circle(\n        [coords[1], coords[0]],\n        500,\n        style\n      ).addTo(map)\n    }\n  },\n\n  // Triggers when race emits events.\n  events: {\n\n    // On click\n    'race-selected': function (race) {\n      this.highlightFeature(race.stage)\n    }\n  }\n}\n</script>\n\n<style>\n/*.stage-1 { fill: red; }*/\n#mapid {\n  height: 100%;\n  width: 100%;\n}\n\n.start{\n  cursor: pointer;\n}\n\n.race-overview{\n  font-family: 'Lato', sans-serif;\n  font-weight: 300;\n  position: absolute;\n  top: 20px;\n  left: 50%;\n  transform: translateX(-50%);\n  z-index: 1;\n  background: #f5da3f;\n  color: #000;\n}\n\n.race-overview p{\n  text-align: center;\n  font-size: 1.250rem;\n  margin: 1em;\n  letter-spacing: 0.1em;\n}\n\n.race-overview p span{\n  display: block;\n  margin: auto;\n  font-size: 1.500rem;\n  text-transform: uppercase;\n  margin-top: 15px;\n  font-weight: 700;\n}\n\n.race-selector{\n  background: rgba(0, 0, 0, 0.1);\n  color: #fff;\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  z-index: 9999;\n}\n\n.navigator{\n  position: absolute;\n  width: 150%;\n  left: 50%;\n  transform: translateX(-50%);\n}\n.navigator p{\n  color: #fff;\n  background: #000;\n  display: inline-block;\n  padding: 1em;\n  margin: 0 -2.7em;\n  cursor: pointer;\n}\n\n.navigator p + p{\n  float: right;\n}\n</style>\n\n\n\n/** WEBPACK FOOTER **\n ** Tdf.vue?490e0883\n **/","module.exports = \" <tdf></tdf> \";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n ** module id = 9\n ** module chunks = 1\n **/","module.exports = \" <div class=race-selector> <race v-for=\\\"race in races | orderBy 'stage'\\\" :race=race> </race> </div> <section class=race-overview> <header> <div v-if=\\\"currentRace != null\\\"> <div class=navigator> <p v-show=\\\"previousRace > 0\\\" v-on:click=highlightFeature(previousRace)> Étape {{ previousRace }} ← </p> <p v-show=\\\"previousRace < races.length\\\" v-on:click=highlightFeature(nextRace)> → Étape {{ nextRace }} </p> </div> <p> Étape {{ currentRace.stage }} <span>{{ currentRace.data.name }}<span> </span></span></p> </div> <div v-else class=start> <p v-on:click=highlightFeature(1)> Tour de France 2016 <span>Cliquez pour commencer</span> </p> </div> </header> </section> <div id=mapid></div> \";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Tdf.vue\n ** module id = 10\n ** module chunks = 1\n **/","module.exports = \" <div v-bind:class=\\\"{ 'active': race.selected }\\\" v-on:click=raceSelected _v-439c647b=\\\"\\\"> Étape {{ race.stage }} : {{ race.data.name }} </div> \";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/template-rewriter.js?id=_v-439c647b!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Race.vue\n ** module id = 11\n ** module chunks = 1\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../node_modules/vue-loader/lib/style-rewriter.js!./../node_modules/vue-loader/lib/selector.js?type=style&index=0!./App.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../node_modules/vue-loader/lib/selector.js?type=script&index=0!./App.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../node_modules/vue-loader/lib/selector.js?type=template&index=0!./App.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/App.vue\n ** module id = 12\n ** module chunks = 1\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js?id=_v-439c647b&scoped=true!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Race.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./Race.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../node_modules/vue-loader/lib/template-rewriter.js?id=_v-439c647b!./../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./Race.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/components/Race.vue\n ** module id = 13\n ** module chunks = 1\n **/","var __vue_script__, __vue_template__\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Tdf.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./Tdf.vue\")\n__vue_template__ = require(\"!!vue-html-loader!./../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./Tdf.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/components/Tdf.vue\n ** module id = 14\n ** module chunks = 1\n **/"],"sourceRoot":""}